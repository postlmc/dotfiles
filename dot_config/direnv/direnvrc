# layout_poetry() {

#     if [[ -v VIRTUAL_ENV ]]; then
#         if whence -w deactivate &>/dev/null; then
#             deactivate
#         else
#             log_error "You're already in a virtual environment. Run \`deactivate\` first."
#             exit 1
#         fi
#     fi

#     PYPROJECT_TOML="${PYPROJECT_TOML:-pyproject.toml}"
#     if [[ ! -f "$PYPROJECT_TOML" ]]; then
#         log_error 'No pyproject.toml found. Use `poetry new` or `poetry init` to create one.'
#         exit 2
#         # Not a fan of auto-running `poetry init` here
#         # log_status "No pyproject.toml found. Executing \`poetry init\` to create a \`$PYPROJECT_TOML\` first."
#         # poetry init
#     fi

#     if [[ -d ".venv" ]]; then
#         VIRTUAL_ENV="$(pwd)/.venv"
#     else
#         VIRTUAL_ENV=$(
#             poetry env info --path 2>/dev/null
#             true
#         )
#     fi

#     if [[ -z $VIRTUAL_ENV || ! -d $VIRTUAL_ENV ]]; then
#         log_status "No virtual environment exists. Executing \`poetry install\` to create one."
#         poetry install
#         VIRTUAL_ENV=$(poetry env info --path)
#     fi

#     PATH_add "$VIRTUAL_ENV/bin"
#     export POETRY_ACTIVE=1
#     export VIRTUAL_ENV
# }

# https://github.com/direnv/direnv/issues/592#issuecomment-1849743637
# layout_poetry() {
#     PYPROJECT_TOML="${PYPROJECT_TOML:-pyproject.toml}"
#     if [[ ! -f "$PYPROJECT_TOML" ]]; then
#         log_status "No pyproject.toml found. Executing \`poetry init\` to create a \`$PYPROJECT_TOML\` first."
#         poetry init
#     fi

#     VIRTUAL_ENV=$(
#         poetry env info --path 2>/dev/null
#         true
#     )
#     if [[ -z $VIRTUAL_ENV || ! -d $VIRTUAL_ENV ]]; then
#         log_status "No virtual environment exists. Executing \`poetry install\` to create one."
#         poetry install
#         VIRTUAL_ENV=$(poetry env info --path)
#     fi

#     PATH_add "$VIRTUAL_ENV/bin"
#     export POETRY_ACTIVE=1
#     export VIRTUAL_ENV
# }

# from: https://github.com/direnv/direnv/wiki/Python#uv
layout_uv() {
    if [[ -d ".venv" ]]; then
        VIRTUAL_ENV="$(pwd)/.venv"
    fi

    if [[ -z $VIRTUAL_ENV || ! -d $VIRTUAL_ENV ]]; then
        log_status "No virtual environment exists. Executing \`uv venv\` to create one."
        uv venv
        VIRTUAL_ENV="$(pwd)/.venv"
    fi

    PATH_add "$VIRTUAL_ENV/bin"
    export UV_ACTIVE=1 # or VENV_ACTIVE=1
    export VIRTUAL_ENV
}
